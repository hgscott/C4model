# figure_code
# Libraries, check which ones are actually needed
library(R.utils)
library(ggplot2)
library(gridExtra)
library(ggpubr)
library(R.matlab)
library(raster)
library(dplyr)
library(tidyr)
library(reshape)
library(maps)
library(R.utils) # Need
library(rgdal)
library(SDMTools)
library(RColorBrewer)
library(grDevices)
library(tiff)
library(ggpubr)
library(tiff)
library(MODISTools)
library(lme4)
# Source model code and functions
# setwd("~/GitHub/C4model")
source("../C4model.R")
sourceDirectory("../functions/", modifiedOnly = FALSE)
source("../Instantaneous_Response.R")
source("../prep_long_data.R")
# Source Nick Smith's C3 model
source('../../optimal_vcmax_R/calc_optimal_vcmax.R')
sourceDirectory('../../optimal_vcmax_R/functions', modifiedOnly = FALSE)
# Sizes of all images
width = 10
height = 6
units = "in"
# Line Graphs (Figures 2 - X)
################################################################################
# Generate data from models
#####
temp_seq <- prep_long_data(tg_c = c(5:40))
par_seq <- prep_long_data(paro = c(0:1000))
vpd_seq <- prep_long_data(vpdo = c(0:8))
co2_seq <- prep_long_data(cao = c(200:1000))
#### Plot Labels ####
labs <- c("Scaled Value",
"Temperature (C)",
expression(paste("Photosynthetically Active Radiation (", mu * mol %.% m^{-2} %.% s^{-1}, ")")),
expression(paste('CO'[2], " (ppm)")),
"Vapor Pressure Deficit (kPa)",
expression(chi["m"]),
expression(chi["bs"]),
expression('J'[max]),
expression('V'[cmax]),
expression('V'[pmax]),
expression(paste('J'[max], "/", 'V'[cmax])),
expression(paste('J'[max], "/", 'V'[pmax])),
expression(paste('V'[cmax], "/", 'V'[pmax])),
" ",
expression(paste("C"[3], " (Acclimated)")),
expression(paste("C"[4], " (Acclimated)")),
expression(paste("C"[4], " (Unacclimated)")),
expression(paste(Photosynthesis," (", mu * mol %.% m^{-2} %.% s^{-1}, ")"))
)
#### Chi Plot (Figure X) ####
chi_temp <- ggplot(filter(temp_seq, Path == "C4" & Status == "Acclimated" &
measure == "chi_m_std"|measure == "chi_bs_std"),
aes(tg_c, value, group = measure)) +
geom_line(size = 2, aes(linetype = measure, color = measure)) +
scale_linetype_manual(values=c("solid", "dashed"), labels = labs[c(7, 6)]) +
scale_color_manual(values=c("#000000", "#000000"), labels = labs[c(7, 6)]) +
labs(y = labs[1], x = labs[2]) +
coord_cartesian(ylim = c(0.25, 1.6)) +
theme_bw() +
theme(axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
legend.position = "bottom",
legend.title = element_blank(),
legend.key.width = unit(5, "line"),
legend.text = element_text(size = 14))
chi_temp
#### Biochemical Variables ####
bc_temp <- ggplot(filter(temp_seq, Path == "C4" & Status == "Acclimated" &
measure == "jmax_std" | measure == "vpmax_std" |
measure == "vcmax_std"),
aes(tg_c, value, group = measure)) +
geom_line(size = 2, aes(linetype = measure, color = measure)) +
scale_linetype_manual(values=c("solid", "dashed", "dotted"), labels = labs[8:10]) +
scale_color_manual(values=c("#473C8B", "#3288BD", "#D53E4F"), labels = labs[8:10]) +
labs(y = labs[1], x = labs[2]) +
coord_cartesian(ylim = c(0, 2)) +
theme_bw() +
theme(axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
legend.position = "bottom",
legend.title = element_blank(),
legend.key.width = unit(5, "line"),
legend.text = element_text(size = 14))
bc_temp
temp_seq$measure
#### Plot Labels ####
labs <- c("Scaled Value",
"Temperature (Â°C)",
expression(paste("Photosynthetically Active Radiation (", mu * mol %.% m^{-2} %.% s^{-1}, ")")),
expression(paste('CO'[2], " (ppm)")),
"Vapor Pressure Deficit (kPa)",
expression(chi["m"]),
expression(chi["bs"]),
expression('J'[max]),
expression('V'[cmax]),
expression('V'[pmax]),
expression(paste('J'[max], "/", 'V'[cmax])),
expression(paste('J'[max], "/", 'V'[pmax])),
expression(paste('V'[cmax], "/", 'V'[pmax])),
" ",
expression(paste("C"[3], " (Acclimated)")),
expression(paste("C"[4], " (Acclimated)")),
expression(paste("C"[4], " (Unacclimated)")),
expression(paste(Photosynthesis," (", mu * mol %.% m^{-2} %.% s^{-1}, ")"))
)
#### Biochemical Variables ####
bc_temp <- ggplot(filter(temp_seq, Path == "C4" & Status == "Acclimated" &
measure == "jmax_std" | measure == "vpmax_std" |
measure == "vcmax_std"),
aes(tg_c, value, group = measure)) +
geom_line(size = 2, aes(linetype = measure, color = measure)) +
scale_linetype_manual(values=c("solid", "dashed", "dotted"), labels = labs[8:10]) +
scale_color_manual(values=c("orange", "blue", "darkgreen"), labels = labs[8:10]) +
labs(y = labs[1], x = labs[2]) +
coord_cartesian(ylim = c(0, 2)) +
theme_bw() +
theme(axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
legend.position = "bottom",
legend.title = element_blank(),
legend.key.width = unit(5, "line"),
legend.text = element_text(size = 14))
bc_temp
bc_temp
#### Biochemical Variables ####
bc_temp <- ggplot(filter(temp_seq, Path == "C4" & Status == "Acclimated" &
measure == "jmax_std" | measure == "vpmax_std" |
measure == "vcmax_std"),
aes(tg_c, value, group = measure)) +
geom_line(size = 2, aes(linetype = measure, color = measure)) +
scale_linetype_manual(values=c("solid", "dashed", "dotted"), labels = labs[8:10]) +
scale_color_manual(values=c("orange", "blue", "darkgreen"), labels = labs[8:10]) +
labs(y = labs[1], x = labs[2]) +
coord_cartesian(ylim = c(0, 2)) +
theme_bw() +
theme(axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
legend.position = "bottom",
legend.title = element_blank(),
legend.key.width = unit(5, "line"),
legend.text = element_text(size = 14))
bc_light <- ggplot(filter(par_seq, Path == "C4" & Status == "Acclimated" &
measure == "jmax_std" | measure == "vpmax_std" |
measure == "vcmax_std"),
aes(par, value, group = measure)) +
geom_line(size = 2, aes(linetype = measure, color = measure)) +
scale_linetype_manual(values=c("solid", "dashed", "dotted"), labels = labs[8:10]) +
scale_color_manual(values=c("orange", "blue", "darkgreen"), labels = labs[8:10]) +
labs(y = labs[14], x = labs[3]) +
coord_cartesian(ylim = c(0, 2)) +
theme_bw() +
theme(axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
legend.position = "bottom",
legend.title = element_blank(),
legend.key.width = unit(5, "line"),
legend.text = element_text(size = 14))
bc_co2 <- ggplot(filter(co2_seq, Path == "C4" & Status == "Acclimated" &
measure == "jmax_std" | measure == "vpmax_std" |
measure == "vcmax_std"),
aes(cao, value, group = measure)) +
geom_line(size = 2, aes(linetype = measure, color = measure)) +
scale_linetype_manual(values=c("solid", "dashed", "dotted"), labels = labs[8:10]) +
scale_color_manual(values=c("orange", "blue", "darkgreen"), labels = labs[8:10]) +
labs(y = labs[1], x = labs[4]) +
coord_cartesian(ylim = c(0, 2)) +
theme_bw() +
theme(axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
legend.position = "bottom",
legend.title = element_blank(),
legend.key.width = unit(5, "line"),
legend.text = element_text(size = 14))
bc_vpd <- ggplot(filter(vpd_seq, Path == "C4" & Status == "Acclimated" &
measure == "jmax_std" | measure == "vpmax_std" |
measure == "vcmax_std"),
aes(vpd, value, group = measure)) +
geom_line(size = 2, aes(linetype = measure, color = measure)) +
scale_linetype_manual(values=c("solid", "dashed", "dotted"), labels = labs[8:10]) +
scale_color_manual(values=c("orange", "blue", "darkgreen"), labels = labs[8:10]) +
labs(y = labs[14], x = labs[5]) +
coord_cartesian(ylim = c(0, 2)) +
theme_bw() +
theme(axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
legend.position = "bottom",
legend.title = element_blank(),
legend.key.width = unit(5, "line"),
legend.text = element_text(size = 14))
ggarrange(bc_temp, bc_light, bc_co2, bc_vpd, ncol = 2, nrow = 2,
common.legend = TRUE, legend="bottom", labels = c("A", "B", "C", "D"),
hjust = c(0, 0.25, 0, 0.25))
# ggsave("biochem.png", width = width, height = width, units = units)
ggsave("biochem_nick.png", width = width, height = width, units = units)
#### C4 (acclimated and unacclimated) vs C3 (acclimated) A (unscaled) #####
a_temp <- ggplot(filter(temp_seq, measure == "Ac" | measure == "A" | measure == "An"),
aes(tg_c, value, group = measure)) +
geom_line(size = 2, aes(linetype = measure, color = measure)) +
scale_linetype_manual(values=c("solid", "dashed", "dotted"), labels = labs[15:17]) +
scale_color_manual(values=c("#CC6666", "#9999CC", "#66CC99"), labels = labs[15:17]) +
labs(y = labs[18], x = labs[2]) +
coord_cartesian(ylim = c(0, 40)) +
theme_bw() +
theme(axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
legend.position = "bottom",
legend.title = element_blank(),
legend.key.width = unit(5, "line"),
legend.text = element_text(size = 14))
a_temp
subset(temp_seq, measure == 'An')$value
subset(temp_seq, measure == 'An')$tg_c
#### C4 (acclimated and unacclimated) vs C3 (acclimated) A (unscaled) #####
# a_temp <- ggplot(filter(temp_seq, measure == "Ac" | measure == "A" | measure == "An"),
a_temp <- ggplot(filter(temp_seq, measure == "Ac" | measure == "A"),
aes(tg_c, value, group = measure)) +
geom_line(size = 2, aes(linetype = measure, color = measure)) +
# scale_linetype_manual(values=c("solid", "dashed", "dotted"), labels = labs[15:17]) +
scale_linetype_manual(values=c("solid", "dashed"), labels = labs[15:17]) +
# scale_color_manual(values=c("#CC6666", "#9999CC", "#66CC99"), labels = labs[15:17]) +
scale_color_manual(values=c("#CC6666", "#9999CC"), labels = labs[15:17]) +
labs(y = labs[18], x = labs[2]) +
coord_cartesian(ylim = c(0, 40)) +
theme_bw() +
theme(axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
legend.position = "bottom",
legend.title = element_blank(),
legend.key.width = unit(5, "line"),
legend.text = element_text(size = 14))
a_temp
# a_light <- ggplot(filter(par_seq, measure == "Ac" | measure == "A" | measure == "An"),
a_light <- ggplot(filter(par_seq, measure == "Ac" | measure == "A"),
aes(par, value, group = measure)) +
geom_line(size = 2, aes(linetype = measure, color = measure)) +
# scale_linetype_manual(values=c("solid", "dashed", "dotted"), labels = labs[15:17]) +
# scale_color_manual(values=c("#CC6666", "#9999CC", "#66CC99"), labels = labs[15:17]) +
scale_linetype_manual(values=c("solid", "dashed"), labels = labs[15:17]) +
scale_color_manual(values=c("#CC6666", "#9999CC"), labels = labs[15:17]) +
labs(y = labs[18], x = labs[3]) +
coord_cartesian(ylim = c(0, 40)) +
theme_bw() +
theme(axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
legend.position = "bottom",
legend.title = element_blank(),
legend.key.width = unit(5, "line"),
legend.text = element_text(size = 14))
# a_co2 <- ggplot(filter(co2_seq, measure == "Ac" | measure == "A" | measure == "An"),
a_co2 <- ggplot(filter(co2_seq, measure == "Ac" | measure == "A"),
aes(cao, value, group = measure)) +
geom_line(size = 2, aes(linetype = measure, color = measure)) +
# scale_linetype_manual(values=c("solid", "dashed", "dotted"), labels = labs[15:17]) +
# scale_color_manual(values=c("#CC6666", "#9999CC", "#66CC99"), labels = labs[15:17]) +
scale_linetype_manual(values=c("solid", "dashed"), labels = labs[15:17]) +
scale_color_manual(values=c("#CC6666", "#9999CC"), labels = labs[15:17]) +
labs(y = labs[18], x = labs[4]) +
coord_cartesian(ylim = c(0, 40)) +
theme_bw() +
theme(axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
legend.position = "bottom",
legend.title = element_blank(),
legend.key.width = unit(5, "line"),
legend.text = element_text(size = 14))
# a_vpd <- ggplot(filter(vpd_seq, measure == "Ac" | measure == "A" | measure == "An"),
a_vpd <- ggplot(filter(vpd_seq, measure == "Ac" | measure == "A"),
aes(vpd, value, group = measure)) +
geom_line(size = 2, aes(linetype = measure, color = measure)) +
# scale_linetype_manual(values=c("solid", "dashed", "dotted"), labels = labs[15:17]) +
# scale_color_manual(values=c("#CC6666", "#9999CC", "#66CC99"), labels = labs[15:17]) +
scale_linetype_manual(values=c("solid", "dashed"), labels = labs[15:17]) +
scale_color_manual(values=c("#CC6666", "#9999CC"), labels = labs[15:17]) +
labs(y = labs[18], x = labs[5]) +
coord_cartesian(ylim = c(0, 40)) +
theme_bw() +
theme(axis.title.y = element_text(size = 14),
axis.title.x = element_text(size = 14),
axis.text.x = element_text(size = 14),
axis.text.y = element_text(size = 14),
legend.position = "bottom",
legend.title = element_blank(),
legend.key.width = unit(5, "line"),
legend.text = element_text(size = 14))
ggarrange(a_temp, a_light, a_co2, a_vpd, ncol=2, nrow=2,
common.legend = TRUE, legend="bottom", labels = c("A", "B", "C", "D"),
hjust = c(0, 0.5, 0, 0.5))
# ggsave("A.png", width = width, height = width, units = units) # Mismatch on purpsoe
ggsave("A_nick.png", width = width, height = width, units = units) # Mismatch on purpsoe
colnames(temp_seq)
#### percent change figures?
(filter(vpd_seq, measure == "A")$value - filter(vpd_seq, measure == "Ac")$value) / filter(vpd_seq, measure == "Ac")$value
filter(vpd_seq, measure == "A")$value
filter(vpd_seq, measure == "Ac")$value
vpd_seq$measure
#### percent change figures?
(filter(vpd_seq, measure == "Ac")$value - filter(vpd_seq, measure == "A")$value) / filter(vpd_seq, measure == "A")$value
(filter(temp_seq, measure == "Ac")$value - filter(temp_seq, measure == "A")$value) / filter(temp_seq, measure == "A")$value
(filter(co2_seq, measure == "Ac")$value - filter(co2_seq, measure == "A")$value) / filter(co2_seq, measure == "A")$value
(filter(par_seq, measure == "Ac")$value - filter(par_seq, measure == "A")$value) / filter(par_seq, measure == "A")$value
(filter(co2_seq, measure == "Ac")$value - filter(co2_seq, measure == "A")$value) / filter(co2_seq, measure == "A")$value
(filter(temp_seq, measure == "Ac")$value - filter(temp_seq, measure == "A")$value) / filter(temp_seq, measure == "A")$value
#### percent change figures?
(filter(vpd_seq, measure == "Ac")$value - filter(vpd_seq, measure == "A")$value) / filter(vpd_seq, measure == "A")$value
temp_seq
temp_seq$tg_c
(filter(temp_seq, measure == "Ac")$value - filter(temp_seq, measure == "A")$value) / filter(temp_seq, measure == "A")$value
(filter(co2_seq, measure == "Ac")$value - filter(co2_seq, measure == "A")$value) / filter(co2_seq, measure == "A")$value
